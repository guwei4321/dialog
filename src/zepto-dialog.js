(function(){(function(root,factory){typeof define=="function"&&define.amd?define("simpletpl",[],factory):typeof exports=="object"?module.exports=factory():root.returnExports=factory()})(this,function(){var config={open:"{{",close:"}}"},tool={exp:function(str){return new RegExp(str,"g")},query:function(type,_,__){var types=["#([\\s\\S])+?","([^{#}])*?"][type||0];return exp((_||"")+config.open+types+config.close+(__||""))},error:function(e,tplog){var error="Laytpl Error\uff1a";return typeof console=="object"&&console.error(error+e+"\n"+(tplog||"")),error+e}},exp=tool.exp;function Tpl(tpl){this.tpl=tpl,this.cache_tpl=null}Tpl.prototype.render=function(data,callback){var _this=this,_html;if(!data)return tool.error("no data");try{this.cache_tpl===null&&(this.cache_tpl=new Function("d",_parse(_this.tpl))),_html=this.cache_tpl(data);if(!callback)return _html;callback(_html)}catch(e){return delete _this.cache_tpl,tool.error(e,this.tpl)}};function _parse(tpl){var _open=exp("^"+config.open+"#",""
),_close=exp(config.close+"$","");return tpl=tpl.replace(exp(config.open+"#"),config.open+"# ").replace(exp(config.close+"}"),"} "+config.close).replace(/\\/g,"\\\\").replace(/(?="|')/g,"\\").replace(tool.query(),function(str){return str=str.replace(_open,"").replace(_close,""),'";'+str.replace(/\\/g,"")+'; view+="'}).replace(tool.query(1),function(str){var start='"+(';return str.replace(/\s/g,"")===config.open+config.close?"":(str=str.replace(exp(config.open+"|"+config.close),""),start+str.replace(/\\/g,"")+')+"')}),'var view = "'+tpl+'";return view;'}var tpl=function(tpl){return new Tpl(tpl)};return tpl}),function(root,factory){typeof define=="function"&&define.amd?define("position",["zepto"],factory):typeof exports=="object"?module.exports=factory(require("zepto")):root.returnExports=factory(root.Zepto)}(this,function(zepto){var win=$(window),doc=$(document),ua=(window.navigator.userAgent||"").toLowerCase(),isIE=ua.indexOf("msie")!==-1,isIE6=ua.indexOf("msie 6")!==-1;function position
(opts){opts=$.extend({},{baseAlign:"50% 50%",parentAlign:"50% 50%",isSticky:!1,parentElement:document.body,baseElement:null},opts);var $elBase=$(opts.baseElement),$elParent=opts.isSticky===!0?win:$(opts.parentElement),parentElementOffset=posConverter(opts.parentAlign,$elParent.width(),$elParent.height()),baseElementOffset=posConverter(opts.baseAlign,$elBase.width(),$elBase.height());if(opts.isSticky===!0)if(isIE6){_reset(),win.on("scroll resize",debounce(function(){var _timer=setTimeout(function(){_reset(),clearTimeout(_timer)},100)}));function _reset(){$elBase.css({position:"absolute",left:doc.scrollLeft()+parentElementOffset[0]-baseElementOffset[0],top:doc.scrollTop()+parentElementOffset[1]-baseElementOffset[1]})}}else $elBase.css({position:"fixed",left:parentElementOffset[0]-baseElementOffset[0],top:parentElementOffset[1]-baseElementOffset[1]});else{var $elParentOffset=$elBase.offsetParent(),parentPos=$elParent.offset(),parentOffsetPos=$elParentOffset.offset();$elBase.css({position:"absolute"
,left:parentElementOffset[0]-baseElementOffset[0]+parentPos.left-parentOffsetPos.left,top:parentElementOffset[1]-baseElementOffset[1]+parentPos.top-parentOffsetPos.top})}}function now(){Date.now||function(){return(new Date).getTime()}}function insertCSS(rule){if(document.styleSheets&&document.styleSheets.length)try{document.styleSheets[0].insertRule(rule,0)}catch(ex){}else{var style=document.createElement("style");style.innerHTML=rule,document.head.appendChild(style)}return}function posSerialize(posItem){var posItems=$.trim(posItem).split(/\s+/);return posItems[1]||(/top|bottom/.test(posItems[0])?(posItems[1]=posItems[0],posItems[0]="center"):posItems[1]="center"),posItems}function posConverter(posItems,width,height){var pos=[0,0],sizes=[width,height],posItemsSerialize=posSerialize(posItems);for(var i=0;i<posItemsSerialize.length;i++)/\w/.test(posItemsSerialize[i])&&(posItemsSerialize[i]=posItemsSerialize[i].replace(/(?:top|left)/gi,"0%").replace(/center/gi,"50%").replace(/(?:bottom|right)/gi
,"100%")),posItemsSerialize[i].indexOf("%")!==-1&&posItemsSerialize[i].replace(/(\d+(?:\.\d+)?)%/gi,function(match,p1){pos[i]+=integerNumber(sizes[i]*toNumber(p1)/100)});return pos}function getElementTop(element){var actualTop=element.offsetTop,current=element.offsetParent;while(current!==null)actualTop+=current.offsetTop,current=current.offsetParent;return actualTop}function toNumber(s){return parseFloat(s,10)||0}function integerNumber(n){return Math.ceil(n,1)}return position}),function(root,factory){typeof define=="function"&&define.amd?define("mask",["zepto"],factory):typeof exports=="object"?module.exports=factory(require("zepto")):root.returnExports=factory(root.Zepto)}(this,function(zepto){var win=$(window),doc=$(document),ua=(window.navigator.userAgent||"").toLowerCase(),isIE=ua.indexOf("msie")!==-1,isIE6=ua.indexOf("msie 6")!==-1;function mask(opts){opts=$.extend({element:null,className:"ui-mask",defaultStyle:{position:isIE6?"absolute":"fixed",top:0,left:0,width:isIE6?doc.outerWidth
(!0):"100%",height:isIE6?doc.outerHeight(!0):"100%"},maskStyle:{backgroundColor:"#000",opacity:.2}},opts,!0),opts.element.addClass(opts.className).css(opts.defaultStyle).css(opts.maskStyle)}return mask}),function(root,factory){typeof define=="function"&&define.amd?define("dialog",["zepto","simpletpl","position","mask"],factory):typeof exports=="object"?module.exports=factory(require("zepto"),require("simpletpl"),require("position"),require("mask")):root.returnExports=factory(root.Zepto,root.tpl,root.position,root.mask)}(this,function(zepto,tpl,position,mask){function Dialog(config){this._instance=!1,this.config=$.extend({},{hasMask:!0,mask:null,maskStyle:{},closeBtn:!0,classWrap:"",width:"auto",height:"auto",parentNode:$("body"),isFixed:!1,align:{baseAlign:"50% 50%",parentAlign:"50% 50%"},title:"",content:"",footer:"",tplMask:'<div class="ui-mask"></div>',tplWrap:'<div class="ui-dialog">{{d._content}}</div>',tplHeader:'{{# if(d.closeBtn || d.title ) { }}<div class="ui-dialog-header">{{# if(d.title) { }}<div class="ui-dialog-title">{{d.title}}</div>{{#} }}{{# if(d.closeBtn) { }}<div class="ui-dialog-close"><a class="ui-icon-dialog-close" href="javascript:;" title="\u5173\u95ed">X</a></div>{{#} }}</div>{{#} }}'
,tplContent:'{{# if(d.content) { }}<div class="ui-dialog-body">{{d.content}}</div>{{#} }}',tplFooter:'{{# if(d.footer) { }}<div class="ui-dialog-footer">{{d.footer}}</div>{{#} }}'},config),$.extend(this,{alert:function(config){var _this=this,_timer=null;_this.config=$.extend(_this.config,{isFixed:!0,closeBtn:!1,title:"\u63d0\u793a",content:"\u5185\u5bb9",footer:"\u786e\u5b9a",classWrap:"ui-dialog-alert",tplFooter:'<div class="ui-dialog-footer"><span>{{d.footer}}</span></div>'},config),_this.setup(),_this.$wrap.addClass("scale"),_timer=setTimeout(function(){_animateFn("animate-out","animate-in"),clearTimeout(_timer)},100),_this.$wrap.on("tap","span:first-child:last-child",function(){$(this).addClass("active-state"),_animateFn("animate-in","animate-out"),_timer=setTimeout(function(){_this.destory(),_this.$wrap.off("tap"),_this.$wrap.trigger("close"),clearTimeout(_timer)},400)});function _animateFn(animateIn,animateOut){_this.$wrap.removeClass(animateIn).addClass(animateOut),_this.$mask.removeClass
(animateIn).addClass(animateOut)}},confrim:function(config){var _this=this,_timer=null;_this.config=$.extend(_this.config,{isFixed:!0,closeBtn:!1,title:"\u63d0\u793a",content:"\u5185\u5bb9",footer:["\u786e\u5b9a","\u53d6\u6d88"],classWrap:"ui-dialog-confrim",tplFooter:'<div class="ui-dialog-footer">{{# for(var i = 0; i < d.footer.length; i++){ }}<span>{{d.footer[i]}}</span>{{#} }}</div>'},config),_this.setup(),_this.$wrap.addClass("scale"),_timer=setTimeout(function(){_animateFn("animate-out","animate-in"),clearTimeout(_timer)},100),_this.$wrap.on("tap","span:first-child",function(){$(this).addClass("active-state"),_animateFn("animate-in","animate-out"),_timer=setTimeout(function(){_this.destory(),_this.$wrap.off("tap"),_this.$wrap.trigger("closeLeft"),clearTimeout(_timer)},400)}).on("tap","span:last-child",function(){$(this).addClass("active-state"),_animateFn("animate-in","animate-out"),_timer=setTimeout(function(){_this.destory(),_this.$wrap.off("tap"),_this.$wrap.trigger("closeRight"
),clearTimeout(_timer)},400)});function _animateFn(animateIn,animateOut){_this.$wrap.removeClass(animateIn).addClass(animateOut),_this.$mask.removeClass(animateIn).addClass(animateOut)}},popover:function(config,duration){var _this=this,_timer=null,_duration=duration||2100;_this.config=$.extend(_this.config,{isFixed:!0,closeBtn:!1,content:"\u6210\u529f",maskStyle:{backgroundColor:"rgba(0,0,0,0)"},classWrap:"ui-dialog-popover"},config),_this.setup(),_timer=setTimeout(function(){_this.$wrap.addClass("animate-in"),clearTimeout(_timer)},100),_this.$wrap.animate({opacity:0},500,"ease-out",function(){_this.destory()},_duration)}})}return $.extend(Dialog.prototype,{setup:function(data){this._render(data),this._instance===!1&&this._appendModel(),this.show(),this._instance=!0},show:function(){var _config=this.config;_config.hasMask&&this.$mask.css("display","block"),this.$wrap.show("display","block"),this._instance===!1&&this._setPosition(),$("html").addClass("alpha")},refresh:function(){},hide:function(
){var _config=this.config;$("html").removeClass("alpha"),_config.hasMask&&this.$mask.css("display","none"),this.$wrap.css("display","none")},destory:function(){var _config=this.config;$("html").removeClass("alpha"),_config.hasMask&&this.$mask.remove(),this.$wrap.remove(),this._instance=!1},_render:function(_data){var _config=this.config,_mask=_config.tplMask,_data=this._update(_data),_content=tpl(_config.tplHeader+_config.tplContent+_config.tplFooter).render(_data);this._instance===!1?(this.$wrap=$(tpl(_config.tplWrap).render({_content:_content})),_config.hasMask&&(this.$mask=$(_mask))):this.$wrap.html(_content)},_appendModel:function(){var _config=this.config;this.$mask&&(this.$mask.appendTo(_config.parentNode),mask({element:this.$mask,maskStyle:_config.maskStyle})),this.$wrap.addClass(_config.classWrap).appendTo(_config.parentNode)},_setPosition:function(){var _config=this.config;_config.isFixed?position({baseElement:this.$wrap,baseAlign:_config.align.baseAlign,parentAlign:_config.align
.parentAlign,isSticky:!0}):position({baseElement:this.$wrap,baseAlign:_config.align.baseAlign,parentAlign:_config.align.parentAlign})},_update:function(_data){var _data=$.extend(this.config,_data);return _data}}),Dialog}),requirejs.config({baseUrl:"./dist",paths:{zepto:"lib/zepto",simpletpl:"extend/simpletpl",position:"zepto.dialog/position",mask:"zepto.dialog/mask",dialog:"zepto.dialog/dialog"}}),define("zepto.dialog/common.js",function(){})})();